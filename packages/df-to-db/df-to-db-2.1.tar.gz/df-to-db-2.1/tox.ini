[tox]
envlist   = tests, docs-{linux, win32}
skipsdist = true
isolated_build = true
allowlist_externals =
    make

[testenv]
platform =
    linux: linux
    win32: win32

[isort]
profile = black
multi_line_output = 3
src_paths=manager
py_version=310
skip=.gitignore,

[gh-actions]
python =
    3.8: py38
    3.9: py39

[testenv:pre-commit]
passenv = *
basepython = python3
deps =
    pre-commit


commands =
    pre-commit run --all-files

[testenv:tests]
passenv = *
basepython = python3

deps =
    pandas
    flake8
    pydocstyle
    black
    coverage
    pytest
    psycopg2-binary
    mysqlclient
    sqlalchemy==1.4.0
    requests
    sqlalchemy-utils
    pymssql
    pymongo
    dnspython
    bandit
    sphinx
    pyarrow
    sphinx-rtd-theme
    dnspython
    google-cloud-bigquery

commands =
    ; python -m pip install -e .
    python calculate_coverage.py
    flake8 write_df
    flake8 tests
    black --check .

[testenv:docs]
passenv = *
basepython = python3
usedevelop = false
deps =
    pandas
    flake8
    pydocstyle
    black
    coverage
    pytest
    psycopg2-binary
    mysqlclient
    sqlalchemy
    requests
    sqlalchemy-utils
    pymssql
    pymongo
    dnspython
    sphinx
    sphinx-rtd-theme
    sphinx-book-theme
    dnspython

[testenv:docs-win32]
allowlist_externals = *
commands =
    .\docs\\make.bat clean
    .\docs\\make.bat html

[testenv:docs-linux]

changedir = docs
allowlist_externals = make

commands =
    make clean
    make html
