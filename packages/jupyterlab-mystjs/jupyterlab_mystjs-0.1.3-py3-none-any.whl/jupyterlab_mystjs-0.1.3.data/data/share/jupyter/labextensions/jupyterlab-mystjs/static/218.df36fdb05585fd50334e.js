"use strict";(self.webpackChunkjupyterlab_mystjs=self.webpackChunkjupyterlab_mystjs||[]).push([[218,904],{45218:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var r=n(63606),o=n(55767),l=n(56271),i=n.n(l),s=n(31952),a=n(31431),c=n(35690),u=n(41929),d=n(14456),m=n(41808),f=n(41423),v=n(8736),h=n(58579),y=n(19732),p=n(54149),g=n(96904),w=n(6079),k=n.n(w),b=n(97524),P=n.n(b),j=n(74305),E=n.n(j),L=n(407),S=n(93874),C=n(44886);const R=e=>t=>{const n=i().useRef(null),{to:r}=t;return i().useEffect((()=>{n&&n.current&&e.rendermime.resolver&&function(e,t,n){let r=e.getAttribute("href")||"";const o=t.isLocal?t.isLocal(r):C.URLExt.isLocal(r);if(!r||!o)return Promise.resolve(void 0);const l=e.hash;if(l){if(l===r)return e.target="_self",Promise.resolve(void 0);r=r.replace(l,"")}t.resolveUrl(r).then((r=>{const o=decodeURIComponent(r);return n&&n.handleLink(e,o,l),t.getDownloadUrl(r)})).then((t=>{e.href=t+l})).catch((t=>{e.href=""}))}(n.current,e.rendermime.resolver,e.rendermime.linkHandler)}),[n,r]),i().createElement("a",{href:r,ref:n},t.children)},T=e=>t=>{!async function(e,t){(0,S.selectAll)("link,linkBlock",e).forEach((async e=>{if(!e||!e.url)return;const n=t.notebook.rendermime.resolver;((null==n?void 0:n.isLocal)?n.isLocal(e.url):C.URLExt.isLocal(e.url))&&(e.internal=!0)}))}(t,e)};class M extends s.MarkdownCell{constructor(){super(...arguments),this.myst={}}renderInput(e){if(!this.myst||!this.myst.node){const e=document.createElement("div");this.myst={node:e}}const t=this.parent;this.myst.pre=void 0,function(e){var t,n,r;const o=null===(t=function(e){const t=null==e?void 0:e.children();if(!t)return;const n=[];let r;do{r=t.next(),r&&n.push(r)}while(r);return n}(e))||void 0===t?void 0:t.filter((e=>"markdown"===e.model.type));if(!o)return;const l={type:"root",children:o.map((e=>{var t,n;const r=null!==(n=null===(t=e.model)||void 0===t?void 0:t.value.text)&&void 0!==n?n:"";return e.myst.pre||(e.myst.pre=function(e){const t=new f.MyST({directives:Object.assign(Object.assign(Object.assign({},k()),P()),E())}).parse(e);return(0,h.l)().use(v.basicTransformationsPlugin).runSync(t),t}(r)),{type:"block",children:(0,g.Bc)(e.myst.pre).children}}))},i=[new v.WikiTransformer,new v.GithubTransformer,new v.DOITransformer,new v.RRIDTransformer],s=new y.k,a={cite:{order:[],data:{}},footnotes:{},article:l},{frontmatter:c}=(0,v.getFrontmatter)(null===(n=l.children[0])||void 0===n?void 0:n.children[0],{removeYaml:!0,removeHeading:!0}),u=(0,p.validatePageFrontmatter)(c,{property:"frontmatter",messages:{}}),d=new v.ReferenceState({numbering:u.numbering,file:s});(0,h.l)().use(v.mathPlugin,{macros:null!==(r=null==u?void 0:u.math)&&void 0!==r?r:{}}).use(v.enumerateTargetsPlugin,{state:d}).use(v.linksPlugin,{transformers:i}).use(v.footnotesPlugin,{references:a}).use(v.resolveReferencesPlugin,{state:d}).use(T,{notebook:e}).use(v.keysPlugin).runSync(l,s),e.myst={references:a,frontmatter:u,mdast:l},s.messages.length>0&&console.log(s.messages),o.forEach((async(e,t)=>{try{await async function(e,t){const n=(0,S.selectAll)("image",e);await Promise.all(n.map((async e=>{var n;if(!e||!e.url)return;const r=null===(n=t.cell.parent.rendermime)||void 0===n?void 0:n.resolver,o=new L.AttachmentsResolver({parent:null!=r?r:void 0,model:t.cell.model.attachments}),l=await o.resolveUrl(e.url);if(!l)return;const i=await o.getDownloadUrl(l);i&&(e.url=i)})))}(l.children[t],{cell:e})}catch(e){}e.myst.post=l.children[t],e.mystRender()}))}(t);const n=new a.Widget({node:this.myst.node});n.addClass("myst"),this.addClass("jp-MySTMarkdownCell"),this.inputArea.renderInput(n)}mystRender(){var e,t;const n=this.parent,r=n.children().next()===this,{post:o}=null!==(e=this.myst)&&void 0!==e?e:{};if(!(null===(t=this.myst)||void 0===t?void 0:t.node)||!(null==n?void 0:n.myst)||!o)return void console.log("MyST: Did not render?",this);const{references:l,frontmatter:s}=n.myst,a=(0,m.useParse)(o);(0,d.render)(i().createElement(u.ThemeProvider,{theme:u.Theme.light,Link:R(n)},i().createElement(u.TabStateProvider,null,i().createElement(u.ReferencesProvider,{references:l,frontmatter:s},r&&i().createElement(c.FrontmatterBlock,{frontmatter:s}),a))),this.myst.node)}}class U extends o.NotebookPanel.ContentFactory{createMarkdownCell(e,t){return e.contentFactory||(e.contentFactory=this),new M(e).initializeState()}}const x={id:"@jupyterlab-mystjs:plugin",provides:o.NotebookPanel.IContentFactory,requires:[r.IEditorServices],autoStart:!0,activate:(e,t)=>{const n=t.factoryService.newInlineEditor;return console.log("Activated MyST content factory"),new U({editorFactory:n})}}},96904:(e,t,n)=>{n.d(t,{Bc:()=>k,Lh:()=>y,Mc:()=>v,_r:()=>a,Q6:()=>c,fX:()=>p,_W:()=>h,Eq:()=>g,lr:()=>w});var r=n(76579);let o=e=>crypto.getRandomValues(new Uint8Array(e)),l=(e,t=21)=>((e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,o=-~(1.6*r*t/e.length);return(l=t)=>{let i="";for(;;){let t=n(o),s=o;for(;s--;)if(i+=e[t[s]&r]||"",i.length===l)return i}}})(e,t,o);var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(e,t){return(null==t?void 0:t.note)&&(e.note=null==t?void 0:t.note),(null==t?void 0:t.url)&&(e.url=null==t?void 0:t.url),(null==t?void 0:t.fatal)&&(e.fatal=!0),e}function a(e,t,n){return s(e.message(t,null==n?void 0:n.node,null==n?void 0:n.source),i(i({},n),{fatal:!0}))}function c(e,t,n){return s(e.message(t,null==n?void 0:n.node,null==n?void 0:n.source),n)}var u="abcdefghijklmnopqrstuvwxyz",d=u+u.toUpperCase(),m=l(d,1),f=l(d+"0123456789",9);function v(){return m()+f()}function h(e){if(e){var t=e.replace(/[\t\n\r ]+/g," ").trim().toLowerCase();return{identifier:t,label:e,html_id:y(t)}}}function y(e){if(e)return e.toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/^([0-9-])/,"id-$1").replace(/-[-]+/g,"-").replace(/(?:^[-]+)|(?:[-]+$)/g,"")}function p(e,t){(0,r.U)(e,(function(e){var n,r,o=null===(r=null===(n=e.children)||void 0===n?void 0:n.map((function(e){return e.type===t&&e.children?e.children:e})))||void 0===r?void 0:r.flat();return void 0!==o&&(e.children=o),e}))}function g(e,t){e.children=[{type:"text",value:t}]}function w(e){return e?Array.isArray(e)?e.map((function(e){return e&&"string"!=typeof e?"value"in e?e.value:"children"in e&&e.children?w(e.children):"":e||""})).join(""):w([e]):""}function k(e){return JSON.parse(JSON.stringify(e))}}}]);